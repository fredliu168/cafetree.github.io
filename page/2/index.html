<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 非鱼笔记</title><meta name="description" content="略懂一点编程."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="https://blog.qzcool.com/atom.xml" title="非鱼笔记"><link rel="alternate" href="/atom.xml" title="非鱼笔记" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">非鱼笔记</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>INDEX</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>ARCHIVES</p></a><ul class="shortcut-icons"><a href="https://github.com/fredliu168" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="body-container"><div id="post-list" class="left"><div class="home post-list"><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/08/18/树莓派通过Nginx发布共享音频文件/" class="post-title-link">树莓派通过Nginx发布共享音频文件</a></h2><div class="post-info">Aug 18, 2020</div><div class="post-content"><p>我们想通过局域网共享一下存放在树莓派里面的音频文件，树莓派安装了树莓派自带的系统。</p>
<p>1、安装 Nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install nginx</span><br></pre></td></tr></table></figure>
<p>2.测试是否安装成功（nginx 默认是 80 端口）</p>
<p>浏览 127.0.0.1 看网页是否正确显示</p>
<p>3.设置配置文件</p>
<p>获取 nginx 配置文件路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /etc/nginx/nginx.conf test is successful</span><br></pre></td></tr></table></figure></div><a href="/2020/08/18/树莓派通过Nginx发布共享音频文件/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/06/15/MacbookPro2015升级SSD固态硬盘/" class="post-title-link">MacbookPro2015升级SSD固态硬盘</a></h2><div class="post-info">Jun 15, 2020</div><div class="post-content"></div><a href="/2020/06/15/MacbookPro2015升级SSD固态硬盘/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/05/27/树莓派搭建Nas/" class="post-title-link">树莓派搭建Nas</a></h2><div class="post-info">May 27, 2020</div><div class="post-content"><p>Step 1: 更新系统</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure>
<p>Step 2: 安装 Samba</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install samba samba-common-bin</span><br></pre></td></tr></table></figure>
<p>Step 3: 挂载移动硬盘</p>
<p>Step 4: 使用 Samba 共享文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/samba/smb.conf</span><br></pre></td></tr></table></figure>
<p>在文件的身份验证下面添加上这一行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">security = user</span><br></pre></td></tr></table></figure>
<p>Step 5: 设置共享文件夹</p>
<p>还是在刚刚那个配置文件上，在结尾添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[MyNas]</span><br><span class="line">path = /home/pi/shared</span><br><span class="line">writeable=Yes</span><br><span class="line">create mask=0777</span><br><span class="line">directory mask=0777</span><br><span class="line">public=no</span><br></pre></td></tr></table></figure>
<p>MyNas: 这定义了与共享文件夹有关的地址和其他配置。例如，共享文件夹将是以下地址：\ raspberrypi \ MyNas。<br>path：共享文件夹目录；<br>valid users：有效用户；<br>read only：是否只读；<br>create mask：创建文件的权限；<br>directory mask：创建文件夹的权限；<br>guest ok：是否允许访客访问；<br>browseable：是否可见。</p>
<p>添加完成后保存就行了，CTRL + X 然后按 Y and 最后敲个回车</p>
<p>Step 6: 添加用户到 Samba</p>
<p>sudo smbpasswd -a pi<br>这一步会让你输入密码，这个密码是等会用来登陆 nas 用的，不是系统的那个密码。</p>
<p>pi 是树莓派默认的用户，如果你想改个名也可以，新建用户就完事了。<br>sudo adduser username<br>sudo smbpasswd -a username</p>
<p>这一步可能要重启 Samba 才能生效—————–注：samba 默认开机自启，无需为重启担心。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo samba restart</span><br></pre></td></tr></table></figure>
<p>挂载 ntfs 格式硬盘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ntfs-3g</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo umount /dev/sda2</span><br></pre></td></tr></table></figure>
<p>格式化 NTFS</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkfs.ntfs -f /dev/sda2</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mount -t ntfs-3g -o permissions /dev/sda2 /home/ubuntu/share</span><br></pre></td></tr></table></figure>
<p>自动挂载设备</p>
<p>查看要指定加载储存设备的 UUID</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo blkid</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/dev/mmcblk0p1: LABEL=”boot” UUID=”CDD4-B453” TYPE=”vfat” PARTUUID=”daf17199-01”</span><br><span class="line">/dev/mmcblk0p2: LABEL=”rootfs” UUID=”72bfc10d-73ec-4d9e-a54a-1cc507ee7ed2” TYPE=”ext4” PARTUUID=”daf17199-02”</span><br><span class="line">/dev/mmcblk0: PTUUID=”daf17199” PTTYPE=”dos”</span><br><span class="line">/dev/sda1: LABEL=”piusb” UUID=”3EFBF3DF518ACC17” TYPE=”ntfs” PARTLABEL=”Basic data partition” PARTUUID=”5cb848ac-2940-462f-8600-e881ce428606”</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 编辑设备管理</span><br><span class="line">sudo vim /etc/fstab</span><br><span class="line">// 在最后一行添加你要挂载的设备</span><br><span class="line">// 针对非 ntfs 格式的移动硬盘</span><br><span class="line">UUID=3EFBF3DF518ACC17 /media/piusb auto defaults,noexec,umask=0000 0 0</span><br><span class="line"></span><br><span class="line">// 针对 ntfs 格式的移动硬盘</span><br><span class="line">UUID=7AE83E6917B75C04 /home/ubuntu/share ntfs-3g defaults,noexec,umask=0000 0 0</span><br></pre></td></tr></table></figure>
<p>作者：HarryZhang6<br>链接：<a href="https://juejin.im/post/5e5c02dc6fb9a07ccb7e9b58" target="_blank" rel="noopener">https://juejin.im/post/5e5c02dc6fb9a07ccb7e9b58</a><br>来源：掘金<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p></div><a href="/2020/05/27/树莓派搭建Nas/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/05/07/显示来自远程JSON文件的SwiftUI列表/" class="post-title-link">显示来自远程JSON文件的SwiftUI列表</a></h2><div class="post-info">May 7, 2020</div><div class="post-content"><p>Displaying a List with SwiftUI from a remote JSON file</p>
<p>显示来自远程 JSON 文件的 SwiftUI 列表</p>
<p>The purpose of this tutorial is to show a simple way to fetch data from a remote JSON file and display it on a List in SwiftUI. Apple has a tutorial with a local file, also this one teaches you how to do this, however I want to show a simpler way using a newer version of Xcode 11.0 (11A420a).</p>
<p>本教程的目的是展示一种从远程 JSON 文件中获取数据并将其显示在 SwiftUI 的 List 中的简单方法。 苹果有一个本地文件的教程，也教你如何做到这一点，但我想显示一个更简单的方式使用新版本的 Xcode 11.0(11A420a)。</p>
<p>Apple beta libraries are getting constantly changed before releasing the final versions, so older tutorials might not work on the latest versions of XCode</p>
<p>在发布最终版本之前，苹果的测试版本库会不断更新，所以以前的教程可能无法在最新版本的 XCode 上工作</p>
<p>Supposing we have this JSON file, that show an array of movie titles.</p>
<p>假设我们有这个 JSON 文件，它显示一组电影标题。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"Joker"</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"2019"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T17:55:21.374Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T17:55:21.374Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"Pulp Fiction"</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"1994"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T15:26:36.675Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:05:31.649Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">" The Godfather "</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"1972"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T15:27:38.123Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:05:50.242Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"The Dark Knight "</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"2008"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T18:06:12.933Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:06:12.933Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"Fight Club"</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"1999"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T18:06:33.096Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:06:33.096Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">" Inception"</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"2010"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T18:06:52.034Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:06:52.034Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"The Matrix "</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"1999"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T15:26:48.042Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:08:00.902Z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"The Shawshank Redemption "</span>,</span><br><span class="line">    <span class="attr">"year"</span>: <span class="string">"1984"</span>,</span><br><span class="line">    <span class="attr">"image"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="attr">"created_at"</span>: <span class="string">"2019-10-06T15:26:59.572Z"</span>,</span><br><span class="line">    <span class="attr">"updated_at"</span>: <span class="string">"2019-10-06T18:08:47.637Z"</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>And we want to display them on a SwiftUI List like this.</p>
<p>我们希望像这样在 SwiftUI 列表中显示它们。</p>
<img src="/2020/05/07/显示来自远程JSON文件的SwiftUI列表/swift_list.png" title="This is an image">
<p>First we need to define the model for Movie in this case a struct with Decodable and Identifiable protocols. Decodable to be able to decode it from the JSON file and Identifiable to be able to be listed with List. List allows you to display a list of data from an Identifiable Collection just like a UITableViewController.</p>
<p>首先，在这种情况下，我们需要为 Movie 定义一个具有可解码和可识别协议的结构。 可解码能够从 JSON 文件解码，可识别能够与列表一起列出。 List 允许您像 UITableViewController 一样显示可识别集合中的数据列表。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Movie</span>: <span class="title">Decodable</span>, <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> id: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> released: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">CodingKeys</span>: <span class="title">String</span>, <span class="title">CodingKey</span> </span>&#123;</span><br><span class="line">           <span class="keyword">case</span> id = <span class="string">"id"</span></span><br><span class="line">           <span class="keyword">case</span> name = <span class="string">"title"</span></span><br><span class="line">           <span class="keyword">case</span> released = <span class="string">"year"</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><a href="/2020/05/07/显示来自远程JSON文件的SwiftUI列表/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/04/29/Mac软件推荐/" class="post-title-link">Mac软件推荐</a></h2><div class="post-info">Apr 29, 2020</div><div class="post-content"><p>1.iRightMouse</p>
<p>iRightMouse 是一款很赞的 Mac 右键菜单扩展应用。包括：右键新建文件、右键移动文件/文件夹到指定文件夹、右键复制文件/文件夹到指定文件夹、右键当前位置打开终端、右键剪切/粘贴、右键显示隐藏文件、右键拷贝文件路径，选中文本右键通过服务快速进行百度翻译/谷歌翻译、右键自定义文件夹图标等功能。</p></div><a href="/2020/04/29/Mac软件推荐/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/04/24/openwrt软路由间歇性断流掉线无法连接的解决办法/" class="post-title-link">openwrt软路由间歇性断流掉线无法连接的解决办法</a></h2><div class="post-info">Apr 24, 2020</div><div class="post-content"></div><a href="/2020/04/24/openwrt软路由间歇性断流掉线无法连接的解决办法/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/04/24/树莓派Docker中使用openwrt做旁路网关/" class="post-title-link">树莓派Docker中使用openwrt做旁路网关</a></h2><div class="post-info">Apr 24, 2020</div><div class="post-content"></div><a href="/2020/04/24/树莓派Docker中使用openwrt做旁路网关/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/04/24/树莓派Docker设置代理/" class="post-title-link">树莓派Docker设置代理</a></h2><div class="post-info">Apr 24, 2020</div><div class="post-content"><p>Docker 无法访问到仓库，网上找的方法都无效，发现 Docker 是通过 snap 安装的，通过下面的方法实现了代理访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/systemd/system/snap.docker.dockerd.service</span><br></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">...</span><br><span class="line">Environment=&quot;HTTPS_PROXY=socks5://127.0.0.1:1080&quot;</span><br></pre></td></tr></table></figure>
<p>然后执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo snap restart docker</span><br></pre></td></tr></table></figure>
<p>然后执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login</span><br></pre></td></tr></table></figure>
<p>可以正常访问到仓库了。</p>
<p>其他（上面的设置突然无效了,使用下面有效）</p>
<p>写入代理设置</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /lib/systemd/system/docker.service.d</span><br><span class="line">cat &gt; /lib/systemd/system/docker.service.d/socks5-proxy.conf &lt;&lt;EOF</span><br><span class="line">[Service]</span><br><span class="line">Environment="ALL_PROXY=socks5://<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">1080</span>"</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p>重新加载配置</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></div><a href="/2020/04/24/树莓派Docker设置代理/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/04/23/Mac设置Anaconda环境变量/" class="post-title-link">Mac设置Anaconda环境变量</a></h2><div class="post-info">Apr 23, 2020</div><div class="post-content"></div><a href="/2020/04/23/Mac设置Anaconda环境变量/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2020/04/17/通过树莓派4共享CMCC上网/" class="post-title-link">通过树莓派4共享CMCC上网</a></h2><div class="post-info">Apr 17, 2020</div><div class="post-content"><p>由于没有其他网络，只能通过 cmcc 上网，想通过共享的方式提供给其他设备上网。手头刚好有个闲置的树莓派 4，树莓派装了 ubuntu 的系统（测试树莓派自带系统同样可用）</p>
<p>步骤一：</p>
<p>a) 设置一下有线网口的 eth0 IP 192.168.1.2，做一下下 nat 转发</p>
<p>b) 把接有线网口的网线连接到小米路由的 wan 口</p>
<p>c) 然后把小米路由器的地址上网设置成静态 IP，网关设置树莓派的 IP</p>
<p>d) 通过其他设备测试是否可以成功连接互联网。</p>
<p>树莓派设置：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 192.168.1.2/24</span><br><span class="line">sysctl net.ipv4.ip_forward=1</span><br><span class="line">iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j MASQUERADE</span><br><span class="line">iptables -t nat -nL</span><br></pre></td></tr></table></figure>
<p>小米路由器设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.3</span><br><span class="line">255.255.255.0</span><br><span class="line">网关：192.168.1.2</span><br><span class="line">DNS：8.8.8.8</span><br></pre></td></tr></table></figure></div><a href="/2020/04/17/通过树莓派4共享CMCC上网/" class="read-more">READ MORE</a></article></div></div></div><div id="sidebar" class="left"><div id="about-panel"><div class="info"><div class="title">Fishman</div><div class="url">https://blog.qzcool.com</div><div class="bio">且行且珍惜</div></div><img src="/images/avatar.png" class="avatar"></div><div id="friend-links-panel"><div class="panel-title"><p>LINKS</p></div><a href="https://www.restran.net" target="_blank" class="link-item"><div class="link-container"><div class="site-name">restran</div><div class="site-desc">淡水</div></div></a></div></div></div><div class="clear"></div></main><footer class="footer-container"><div class="paginator"><a href="/" class="prev">PREV</a><a href="/page/3/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 - 2021 <a href="https://blog.qzcool.com">fredliu</a>,<a href="http://www.beian.miit.gov.cn">备案编号:闽ICP备17012963号-1</a> powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"fishman",'auto');ga('send','pageview');</script></body></html>