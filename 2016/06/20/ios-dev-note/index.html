<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> iOS开发知识点小结 · 非鱼笔记</title><meta name="description" content="iOS开发知识点小结 - fredliu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="https://blog.qzcool.com/atom.xml" title="非鱼笔记"><link rel="alternate" href="/atom.xml" title="非鱼笔记" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">非鱼笔记</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>INDEX</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>ARCHIVES</p></a><ul class="shortcut-icons"><a href="https://github.com/fredliu168" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title">iOS开发知识点小结</h1><div class="post-info">Jun 20, 2016</div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>主要记录日常开发常用到得一些功能记录,包括URL Schemes,NSDictionary,UITableView等.</p>
<h2 id="NSDate"><a href="#NSDate" class="headerlink" title="NSDate"></a>NSDate</h2><p>获取时间戳:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSDate</span> *datenow = [<span class="built_in">NSDate</span> date]; </span><br><span class="line"><span class="built_in">NSString</span> *timeSp = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%ld"</span>, </span><br><span class="line">(<span class="keyword">long</span>)[datenow timeIntervalSince1970]];</span><br></pre></td></tr></table></figure></p>
<h2 id="获取应用版本号"><a href="#获取应用版本号" class="headerlink" title="获取应用版本号"></a>获取应用版本号</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *app_Version = [[[<span class="built_in">NSBundle</span> mainBundle] infoDictionary]</span><br><span class="line">objectForKey:<span class="string">@"CFBundleShortVersionString"</span>]; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> currentCode = [[[[<span class="built_in">NSBundle</span> mainBundle] infoDictionary]</span><br><span class="line">objectForKey:<span class="string">@"CFBundleVersion"</span>] intValue];</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="URL-Schemes"><a href="#URL-Schemes" class="headerlink" title="URL Schemes"></a>URL Schemes</h2><h3 id="适配ios9出现的问题：-canOpenURL-failed-for-URL"><a href="#适配ios9出现的问题：-canOpenURL-failed-for-URL" class="headerlink" title="适配ios9出现的问题：-canOpenURL: failed for URL"></a>适配ios9出现的问题：-canOpenURL: failed for URL</h3><p>除了要在项目info URL Types中设置URL Schemes，还需要在info.plist里面增加可信任的调用app，否则回报如下错误</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-canOpenURL: failed <span class="keyword">for</span> URL: <span class="string">"wtloginmqq2://qzapp"</span> </span><br><span class="line">- error: <span class="string">"This app is not allowed to query for scheme wtloginmqq2"</span></span><br></pre></td></tr></table></figure>
<p>info.plist加入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;</span><br><span class="line">&lt;array&gt;</span><br><span class="line">&lt;string&gt;urlscheme&lt;/string&gt;</span><br><span class="line">&lt;string&gt;urlscheme2&lt;/string&gt;</span><br><span class="line">&lt;string&gt;urlscheme3&lt;/string&gt; </span><br><span class="line">&lt;/array&gt;</span><br></pre></td></tr></table></figure>
<h2 id="NSDictionary的使用"><a href="#NSDictionary的使用" class="headerlink" title="NSDictionary的使用"></a>NSDictionary的使用</h2><h3 id="用NSDictionary来解析Json数据"><a href="#用NSDictionary来解析Json数据" class="headerlink" title="用NSDictionary来解析Json数据"></a>用NSDictionary来解析Json数据</h3><p>假设json数据格式如下:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"value"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"biz_code"</span>: <span class="string">"501100000228416"</span>,</span><br><span class="line">            <span class="attr">"biz_name"</span>: <span class="string">"圣湖东兴商住楼H"</span>,</span><br><span class="line">            <span class="attr">"biz_lng"</span>: <span class="string">"118.605877"</span>,</span><br><span class="line">            <span class="attr">"biz_lat"</span>: <span class="string">"24.903232"</span>,</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"biz_code"</span>: <span class="string">"501100000625763"</span>,</span><br><span class="line">            <span class="attr">"biz_name"</span>: <span class="string">"丰泽圣湖家园"</span>,</span><br><span class="line">            <span class="attr">"biz_lng"</span>: <span class="string">"118.962019"</span>,</span><br><span class="line">            <span class="attr">"biz_lat"</span>: <span class="string">"24.964523"</span>,</span><br><span class="line">        &#125;],</span><br><span class="line">     <span class="attr">"code"</span>:<span class="number">10000</span>,</span><br><span class="line">     <span class="attr">"message"</span>:<span class="string">"获取数据成功"</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>如何解析该数据呢?</p>
<p>如果json是NSData数据类型,直接用NSJSONSerialization系列化,如果是NSString类型的,先转成NSData数据类型</p>
<p>代码如下:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//json数据</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *json = <span class="string">@"&#123;\"value\":[&#123;\"biz_code\":\"501100000228416\",...&#125;,...],"</span>code<span class="string">":10000,\"message\":\"获取数据成功\"&#125;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//转成NSData</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSData</span> *json_data =  [json dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//转成字典 </span></span><br><span class="line"><span class="built_in">NSError</span> *error; </span><br><span class="line"><span class="built_in">NSDictionary</span> *jsonDic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:json_data options:<span class="built_in">NSJSONReadingMutableLeaves</span> error:&amp;error];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSArray</span>  *value      = [jsonDic objectForKey:<span class="string">@"value"</span>];  </span><br><span class="line"><span class="keyword">int</span>      code        = [[jsonDic objectForKey:<span class="string">@"code"</span>] intValue];</span><br><span class="line"><span class="built_in">NSString</span> *message    = [jsonDic objectForKey:<span class="string">@"message"</span>]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(code == <span class="number">10000</span>) </span><br><span class="line">&#123;    </span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">NSDictionary</span> *dicObj <span class="keyword">in</span> value)</span><br><span class="line">	&#123; </span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSString</span> *biz_code = [dicObj objectForKey:<span class="string">@"biz_code"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *biz_name = [dicObj objectForKey:<span class="string">@"biz_name"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *biz_lng = [dicObj objectForKey:<span class="string">@"biz_lng"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *biz_lat=  [dicObj objectForKey:<span class="string">@"biz_lat"</span>]; </span><br><span class="line">     <span class="built_in">NSLog</span>(<span class="string">@"biz_code:%@ biz_name:%@ biz_lng:%@ biz_lat:%@"</span>,biz_code,biz_name,biz_lng,biz_lat);</span><br><span class="line"></span><br><span class="line"> &#125;  </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>如果josn NSData 数据类型如果要转成NSString查看,用如下方法:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *strJson = [[<span class="built_in">NSString</span> alloc]initWithData:json_data encoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"json:%@"</span>,json);</span><br></pre></td></tr></table></figure>
<h2 id="点击-UITableView-隐藏键盘"><a href="#点击-UITableView-隐藏键盘" class="headerlink" title="点击-UITableView-隐藏键盘"></a>点击-UITableView-隐藏键盘</h2><p>在 UITableView 上加手势</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">UITapGestureRecognizer</span> *gestureRecognizer = [[<span class="built_in">UITapGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(hideKeyboard)];</span><br><span class="line">[<span class="keyword">self</span>.tableView addGestureRecognizer:gestureRecognizer];</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>) hideKeyboard &#123;</span><br><span class="line"></span><br><span class="line">    [textField1 resignFirstResponder];</span><br><span class="line"></span><br><span class="line">    [textField2 resignFirstResponder];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ps:加上这句不会影响你 tableview 上的 action (button,cell selected…)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gestureRecognizer.cancelsTouchesInView = <span class="literal">NO</span>;</span><br></pre></td></tr></table></figure>
</div></article></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'fishman-1';
var disqus_identifier = '2016/06/20/ios-dev-note/';
var disqus_title = 'iOS开发知识点小结';
var disqus_url = 'https://blog.qzcool.com/2016/06/20/ios-dev-note/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//fishman-1.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a href="/2016/06/21/mac-redis/" class="prev">PREV</a><a href="/2016/06/20/h5-send-sms/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 - 2021 <a href="https://blog.qzcool.com">fredliu</a>,<a href="http://www.beian.miit.gov.cn">备案编号:闽ICP备17012963号-1</a> powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"fishman",'auto');ga('send','pageview');</script></body></html>